<!--
SPDX-FileCopyrightText: 2019-2020 Intel Corporation

SPDX-License-Identifier: MIT
-->



<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Streaming and Video Conferencing Features &mdash; oneAPI Specification 1.0-rev-2 documentation</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../../../_static/favicons.png"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/language_data.js"></script>
        <script src="../../../../_static/custom.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Switchable Graphics and Multiple Monitors" href="VPL_apnds_d.html" />
    <link rel="prev" title="Multiple-segment Encoding" href="VPL_apnds_b.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="https://oneapi.com" class="icon icon-home"> oneAPI Specification
          

          
            
            <img src="../../../../_static/oneAPI-rgb-rev-100.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.0-rev-2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../architecture.html">Software Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dpcpp/source/index.html">DPC++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneDPL/source/index.html">oneDPL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneDNN/source/index.html">oneDNN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneCCL/source/index.html">oneCCL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../l0/source/index.html">Level Zero</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneDAL/source/index.html">oneDAL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneTBB/source/nested-index.html">oneTBB</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">oneVPL</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../architecture/index.html">Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../programming_guide/index.html">Programming Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../VPL_summary.html">Mandatory APIs and Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../API_ref/VPL_api_ref.html">oneVPL API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Versioning.html">oneVPL API Versioning</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Appendices</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="VPL_intel_media_sdk.html">oneVPL for Intel<sup>®</sup> Media Software Development Kit Users</a></li>
<li class="toctree-l3"><a class="reference internal" href="VPL_apnds_a.html">Configuration Parameter Constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="VPL_apnds_b.html">Multiple-segment Encoding</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Streaming and Video Conferencing Features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dynamic-bitrate-change">Dynamic Bitrate Change</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dynamic-resolution-change">Dynamic Resolution Change</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dynamic-reference-frame-scaling">Dynamic Reference Frame Scaling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#forced-keyframe-generation">Forced Keyframe Generation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reference-list-selection">Reference List Selection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#low-latency-encoding-and-decoding">Low Latency Encoding and Decoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reference-picture-marking-repetition-sei-message">Reference Picture Marking Repetition SEI Message</a></li>
<li class="toctree-l4"><a class="reference internal" href="#long-term-reference-frame">Long Term Reference Frame</a></li>
<li class="toctree-l4"><a class="reference internal" href="#temporal-scalability">Temporal Scalability</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="VPL_apnds_d.html">Switchable Graphics and Multiple Monitors</a></li>
<li class="toctree-l3"><a class="reference internal" href="VPL_apnds_e.html">Working Directly with VA API for Linux*</a></li>
<li class="toctree-l3"><a class="reference internal" href="VPL_apnds_f.html">CQP HRD Mode Encoding</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../VPL_acronyms.html">Glossary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneMKL/source/index.html">oneMKL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../versions.html">HTML and PDF Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notices.html">Legal Notices and Disclaimers</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">oneAPI Specification</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          <!--
SPDX-FileCopyrightText: 2019-2020 Intel Corporation

SPDX-License-Identifier: MIT
-->

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">oneAPI Specification</a> &raquo;</li>
        
          
          <li><a href="../index.html">oneVPL</a> </li>
          
        
          
        
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/oneapi-src/oneapi-spec/blob/master/source/elements/oneVPL/source/appendix/VPL_apnds_c.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="streaming-and-video-conferencing-features">
<span id="stream-vid-conf-features"></span><h1>Streaming and Video Conferencing Features<a class="headerlink" href="#streaming-and-video-conferencing-features" title="Permalink to this headline">¶</a></h1>
<p>The following sections address some aspects of additional requirements that
streaming or video conferencing applications may use in the encoding or
transcoding process. See the <a class="reference internal" href="../programming_guide/VPL_prg_encoding.html#config-change"><span class="std std-ref">Configuration Change</span></a> section for additional
information.</p>
<div class="section" id="dynamic-bitrate-change">
<h2>Dynamic Bitrate Change<a class="headerlink" href="#dynamic-bitrate-change" title="Permalink to this headline">¶</a></h2>
<p>The oneVPL encoder supports dynamic bitrate change according to bitrate control mode
and HRD conformance requirements. If HRD conformance is required, for example if
the application sets the <code class="docutils literal notranslate"><span class="pre">NalHrdConformance</span></code> option in the
<a class="reference internal" href="../API_ref/VPL_structs_encode.html#_CPPv418mfxExtCodingOption" title="mfxExtCodingOption"><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">mfxExtCodingOption</span></code></a> structure to ON, the only allowed
bitrate control mode is VBR. In this mode, the application can change the
<code class="docutils literal notranslate"><span class="pre">TargetKbps</span></code> and <code class="docutils literal notranslate"><span class="pre">MaxKbps</span></code> values of the <a class="reference internal" href="../API_ref/VPL_structs_cross_component.html#_CPPv410mfxInfoMFX" title="mfxInfoMFX"><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">mfxInfoMFX</span></code></a> structure
by calling the  <a class="reference internal" href="../API_ref/VPL_func_vid_encode.html#_CPPv420MFXVideoENCODE_Reset10mfxSessionP13mfxVideoParam" title="MFXVideoENCODE_Reset"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXVideoENCODE_Reset()</span></code></a> function. This sort of change in
bitrate usually results in the generation of a new keyframe and sequence header.
There are exceptions, such as if HRD information is absent in the stream.
In this scenario, the change of <code class="docutils literal notranslate"><span class="pre">TargetKbps</span></code> does not require a change in the
sequence header and as a result the encoder does not insert a keyframe.</p>
<p>If HRD conformance is not required, for example if the application turns off
the <code class="docutils literal notranslate"><span class="pre">NalHrdConformance</span></code> option in the <a class="reference internal" href="../API_ref/VPL_structs_encode.html#_CPPv418mfxExtCodingOption" title="mfxExtCodingOption"><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">mfxExtCodingOption</span></code></a>
structure, all bitrate control modes are available. In CBR and AVBR modes the
application can change <code class="docutils literal notranslate"><span class="pre">TargetKbps</span></code>. In VBR mode the application can change
<code class="docutils literal notranslate"><span class="pre">TargetKbps</span></code> and <code class="docutils literal notranslate"><span class="pre">MaxKbps</span></code> values. This sort of change in bitrate will not
result in the generation of a new keyframe or sequence header.</p>
<p>The oneVPL encoder may change some initialization parameters provided by the
application during initialization. That in turn may lead to incompatibility
between the parameters provided by the application during reset and the working set
of parameters used by the encoder. For this reason, it is strongly recommended
to retrieve the actual working parameters using the
<a class="reference internal" href="../API_ref/VPL_func_vid_encode.html#_CPPv428MFXVideoENCODE_GetVideoParam10mfxSessionP13mfxVideoParam" title="MFXVideoENCODE_GetVideoParam"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXVideoENCODE_GetVideoParam()</span></code></a> function before making any changes to
bitrate settings.</p>
<p>In all modes, oneVPL encoders will respond to the bitrate changes as quickly as
the underlying algorithm allows, without breaking other encoding restrictions
such as HRD compliance if it is enabled. How quickly the actual bitrate can catch
up with the specified bitrate is implementation dependent.</p>
<p>Alternatively, the application may use the <a class="reference internal" href="../VPL_acronyms.html#term-CQP"><span class="xref std std-term">CQP</span></a> encoding mode to perform
customized bitrate adjustment on a per-frame base. The application may use any
of the encoded or display order modes to use per-frame CQP.</p>
</div>
<div class="section" id="dynamic-resolution-change">
<h2>Dynamic Resolution Change<a class="headerlink" href="#dynamic-resolution-change" title="Permalink to this headline">¶</a></h2>
<p>The oneVPL encoder supports dynamic resolution change in all bitrate control modes.
The application may change resolution by calling the <a class="reference internal" href="../API_ref/VPL_func_vid_encode.html#_CPPv420MFXVideoENCODE_Reset10mfxSessionP13mfxVideoParam" title="MFXVideoENCODE_Reset"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXVideoENCODE_Reset()</span></code></a>
function. The application may decrease or increase resolution up to the size
specified during encoder initialization.</p>
<p>Resolution change always results in the insertion of a key IDR frame and a new
sequence parameter set in the header. The only exception is the oneVPL VP9 encoder
(see section for <a class="reference internal" href="#dynamic-reference-frame-scaling">Dynamic reference frame scaling</a>). The oneVPL encoder does not
guarantee HRD conformance across the resolution change point.</p>
<p>The oneVPL encoder may change some initialization parameters provided by the
application during initialization. That in turn may lead to incompatibility of
parameters provide by the application during reset and working set of parameters
used by the encoder. Due to this potential incompatibility, it is strongly
recommended to retrieve the actual working parameters set by
<a class="reference internal" href="../API_ref/VPL_func_vid_encode.html#_CPPv428MFXVideoENCODE_GetVideoParam10mfxSessionP13mfxVideoParam" title="MFXVideoENCODE_GetVideoParam"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXVideoENCODE_GetVideoParam()</span></code></a> function before making any resolution
change.</p>
</div>
<div class="section" id="dynamic-reference-frame-scaling">
<h2>Dynamic Reference Frame Scaling<a class="headerlink" href="#dynamic-reference-frame-scaling" title="Permalink to this headline">¶</a></h2>
<p>The VP9 standard allows changing the resolution without the insertion of a
keyframe. This is possible because the VP9 encoder has the built-in capability
to upscale and downscale reference frames to match the resolution of the frame
being encoded. By default the oneVPL VP9 encoder inserts a keyframe when the
application does <a class="reference internal" href="#dynamic-resolution-change">Dynamic Resolution Change</a>. In this case, the first frame
with a new resolution is encoded using inter prediction from the scaled reference
frame of the previous resolution. Dynamic scaling has the following limitations,
described in the VP9 specification:</p>
<ul class="simple">
<li><p>The resolution of any active reference frame cannot exceed 2x the resolution
of the current frame.</p></li>
<li><p>The resolution of any active reference frame cannot be smaller than 1/16 of
the current frame resolution.</p></li>
</ul>
<p>In the case of dynamic scaling, the oneVPL VP9 encoder always uses a single active
reference frame for the first frame after a resolution change. The VP9
encoder has the following limitations for dynamic resolution change:</p>
<ul class="simple">
<li><p>The new resolution should not exceed 16x the resolution of the current frame.</p></li>
<li><p>The new resolution should be less than 1/2 of current frame resolution.</p></li>
</ul>
<p>The application may force insertion of a keyframe at the point of resolution
change by invoking encoder reset with <a class="reference internal" href="../API_ref/VPL_structs_encode.html#_CPPv4N24mfxExtEncoderResetOption16StartNewSequenceE" title="mfxExtEncoderResetOption::StartNewSequence"><code class="xref cpp cpp-member docutils literal notranslate"><span class="pre">mfxExtEncoderResetOption::StartNewSequence</span></code></a>
set to <a class="reference internal" href="../API_ref/VPL_enums.html#_CPPv419MFX_CODINGOPTION_ON" title="MFX_CODINGOPTION_ON"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">MFX_CODINGOPTION_ON</span></code></a>. If a keyframe is inserted, the
dynamic resolution limitations are not enforced.</p>
<p>Note that resolution change with dynamic reference scaling is compatible with
multiref (<a class="reference internal" href="../API_ref/VPL_structs_cross_component.html#_CPPv4N10mfxInfoMFX11NumRefFrameE" title="mfxInfoMFX::NumRefFrame"><code class="xref cpp cpp-member docutils literal notranslate"><span class="pre">mfxInfoMFX::NumRefFrame</span></code></a> &gt; 1). For multiref
configuration, the oneVPL VP9 encoder uses multiple references within stream pieces
of the same resolution and uses a single reference at the place of resolution
change.</p>
</div>
<div class="section" id="forced-keyframe-generation">
<h2>Forced Keyframe Generation<a class="headerlink" href="#forced-keyframe-generation" title="Permalink to this headline">¶</a></h2>
<p>oneVPL supports forced keyframe generation during encoding. The application
can set the FrameType parameter of the <a class="reference internal" href="../API_ref/VPL_structs_encode.html#_CPPv413mfxEncodeCtrl" title="mfxEncodeCtrl"><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">mfxEncodeCtrl</span></code></a> structure to
control how the current frame is encoded, as follows:</p>
<ul class="simple">
<li><p>If the oneVPL encoder works in the display order, the application can enforce any
current frame to be a keyframe. The application cannot change the frame type
of already buffered frames inside the encoder.</p></li>
<li><p>If the oneVPL encoder works in the encoded order, the application must specify
exact frame type for every frame. In this way, the application can enforce the
current frame to have any frame type that the particular coding standard allows.</p></li>
</ul>
</div>
<div class="section" id="reference-list-selection">
<span id="sec-reference-list-selection"></span><h2>Reference List Selection<a class="headerlink" href="#reference-list-selection" title="Permalink to this headline">¶</a></h2>
<p>During streaming or video conferencing, if the application can obtain feedback
about how well the client receives certain frames, the application may need to
adjust the encoding process to use or not use certain frames as reference. This
section describes how to fine-tune the encoding process based on client feedback.</p>
<p>The application can specify the reference window size by specifying the
<a class="reference internal" href="../API_ref/VPL_structs_cross_component.html#_CPPv4N10mfxInfoMFX11NumRefFrameE" title="mfxInfoMFX::NumRefFrame"><code class="xref cpp cpp-member docutils literal notranslate"><span class="pre">mfxInfoMFX::NumRefFrame</span></code></a> parameter during encoding initialization.
Certain platforms may have limits on the the size of the reference window. Use the
<a class="reference internal" href="../API_ref/VPL_func_vid_encode.html#_CPPv428MFXVideoENCODE_GetVideoParam10mfxSessionP13mfxVideoParam" title="MFXVideoENCODE_GetVideoParam"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXVideoENCODE_GetVideoParam()</span></code></a> function to retrieve the current working
set of parameters.</p>
<p>During encoding, the application can specify the actual reference list lengths
by attaching the <a class="reference internal" href="../API_ref/VPL_structs_encode.html#_CPPv420mfxExtAVCRefListCtrl" title="mfxExtAVCRefListCtrl"><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">mfxExtAVCRefListCtrl</span></code></a> structure to the
<a class="reference internal" href="../API_ref/VPL_func_vid_encode.html#_CPPv431MFXVideoENCODE_EncodeFrameAsync10mfxSessionP13mfxEncodeCtrlP16mfxFrameSurface1P12mfxBitstreamP12mfxSyncPoint" title="MFXVideoENCODE_EncodeFrameAsync"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXVideoENCODE_EncodeFrameAsync()</span></code></a> function. <code class="docutils literal notranslate"><span class="pre">NumRefIdxL0Active</span></code>
specifies the length of the reference list L0 and <code class="docutils literal notranslate"><span class="pre">NumRefIdxL1Active</span></code> specifies
the length of the reference list L1. These two numbers must be less than or equal
to the <a class="reference internal" href="../API_ref/VPL_structs_cross_component.html#_CPPv4N10mfxInfoMFX11NumRefFrameE" title="mfxInfoMFX::NumRefFrame"><code class="xref cpp cpp-member docutils literal notranslate"><span class="pre">mfxInfoMFX::NumRefFrame</span></code></a> parameter during encoding initialization.</p>
<p>The application can instruct the oneVPL encoder to use or not use certain reference
frames. To do this, there is a prerequisite that the application uniquely
identify each input frame by setting the <a class="reference internal" href="../API_ref/VPL_structs_memory.html#_CPPv4N12mfxFrameData10FrameOrderE" title="mfxFrameData::FrameOrder"><code class="xref cpp cpp-member docutils literal notranslate"><span class="pre">mfxFrameData::FrameOrder</span></code></a>
parameter. The application then specifies the preferred reference frame list
<code class="docutils literal notranslate"><span class="pre">PreferredRefList</span></code> and/or the rejected frame list <code class="docutils literal notranslate"><span class="pre">RejectedRefList</span></code>, and
attaches the <a class="reference internal" href="../API_ref/VPL_structs_encode.html#_CPPv420mfxExtAVCRefListCtrl" title="mfxExtAVCRefListCtrl"><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">mfxExtAVCRefListCtrl</span></code></a> structure to the
<a class="reference internal" href="../API_ref/VPL_func_vid_encode.html#_CPPv431MFXVideoENCODE_EncodeFrameAsync10mfxSessionP13mfxEncodeCtrlP16mfxFrameSurface1P12mfxBitstreamP12mfxSyncPoint" title="MFXVideoENCODE_EncodeFrameAsync"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXVideoENCODE_EncodeFrameAsync()</span></code></a> function. The two lists fine-tune how
the encoder chooses the reference frames for the current frame.
The encoder does not keep <code class="docutils literal notranslate"><span class="pre">PreferredRefList</span></code> and the application must send it
for each frame if necessary. There are limitations as follows:</p>
<ul class="simple">
<li><p>The frames in the lists are ignored if they are out of the reference window.</p></li>
<li><p>If by going through the lists, the oneVPL encoder cannot find a reference frame
for the current frame, the encoder will encode the current frame without
using any reference frames.</p></li>
<li><p>If the GOP pattern contains B-frames, the oneVPL encoder may not be able to follow
the <a class="reference internal" href="../API_ref/VPL_structs_encode.html#_CPPv420mfxExtAVCRefListCtrl" title="mfxExtAVCRefListCtrl"><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">mfxExtAVCRefListCtrl</span></code></a> instructions.</p></li>
</ul>
</div>
<div class="section" id="low-latency-encoding-and-decoding">
<h2>Low Latency Encoding and Decoding<a class="headerlink" href="#low-latency-encoding-and-decoding" title="Permalink to this headline">¶</a></h2>
<p>The application can set <a class="reference internal" href="../API_ref/VPL_structs_cross_component.html#_CPPv4N13mfxVideoParam10AsyncDepthE" title="mfxVideoParam::AsyncDepth"><code class="xref cpp cpp-member docutils literal notranslate"><span class="pre">mfxVideoParam::AsyncDepth</span></code></a> = 1 to disable
any decoder buffering of output frames, which is aimed to improve the transcoding
throughput. With <a class="reference internal" href="../API_ref/VPL_structs_cross_component.html#_CPPv4N13mfxVideoParam10AsyncDepthE" title="mfxVideoParam::AsyncDepth"><code class="xref cpp cpp-member docutils literal notranslate"><span class="pre">mfxVideoParam::AsyncDepth</span></code></a> = 1, the application
must synchronize after the decoding or transcoding operation of each frame.</p>
<p>The application can adjust <a class="reference internal" href="../API_ref/VPL_structs_encode.html#_CPPv4N18mfxExtCodingOption20MaxDecFrameBufferingE" title="mfxExtCodingOption::MaxDecFrameBuffering"><code class="xref cpp cpp-member docutils literal notranslate"><span class="pre">mfxExtCodingOption::MaxDecFrameBuffering</span></code></a>
during encoding initialization to improve decoding latency. It is recommended to
set this value equal to the number of reference frames.</p>
</div>
<div class="section" id="reference-picture-marking-repetition-sei-message">
<h2>Reference Picture Marking Repetition SEI Message<a class="headerlink" href="#reference-picture-marking-repetition-sei-message" title="Permalink to this headline">¶</a></h2>
<p>The application can request writing the reference picture marking repetition SEI
message during encoding initialization by setting <code class="docutils literal notranslate"><span class="pre">RefPicMarkRep</span></code> of the
<a class="reference internal" href="../API_ref/VPL_structs_encode.html#_CPPv418mfxExtCodingOption" title="mfxExtCodingOption"><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">mfxExtCodingOption</span></code></a> structure. The reference picture marking
repetition SEI message repeats certain reference frame information in the output
bitstream for robust streaming.</p>
<p>The oneVPL decoder will respond to the reference picture marking repetition SEI
message if the message exists in the bitstream and compare it to the reference
list information specified in the sequence/picture headers. The decoder will
report any mismatch of the SEI message with the reference list information in
the <a class="reference internal" href="../API_ref/VPL_structs_memory.html#_CPPv4N12mfxFrameData9CorruptedE" title="mfxFrameData::Corrupted"><code class="xref cpp cpp-member docutils literal notranslate"><span class="pre">mfxFrameData::Corrupted</span></code></a> field.</p>
</div>
<div class="section" id="long-term-reference-frame">
<span id="sec-long-term-reference-frame"></span><h2>Long Term Reference Frame<a class="headerlink" href="#long-term-reference-frame" title="Permalink to this headline">¶</a></h2>
<p>The application may use long term reference frames to improve coding efficiency
or robustness for video conferencing applications. The application controls the
long term frame marking process by attaching the <a class="reference internal" href="../API_ref/VPL_structs_encode.html#_CPPv420mfxExtAVCRefListCtrl" title="mfxExtAVCRefListCtrl"><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">mfxExtAVCRefListCtrl</span></code></a>
extended buffer during encoding. The oneVPL encoder itself never marks a frame as
long term.</p>
<p>There are two control lists in the <a class="reference internal" href="../API_ref/VPL_structs_encode.html#_CPPv420mfxExtAVCRefListCtrl" title="mfxExtAVCRefListCtrl"><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">mfxExtAVCRefListCtrl</span></code></a> extended
buffer. The <code class="docutils literal notranslate"><span class="pre">LongTermRefList</span></code> list contains the frame orders (the <code class="docutils literal notranslate"><span class="pre">FrameOrder</span></code>
value in the <a class="reference internal" href="../API_ref/VPL_structs_memory.html#_CPPv412mfxFrameData" title="mfxFrameData"><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">mfxFrameData</span></code></a> structure) of the frames that should be
marked as long term frames. The <code class="docutils literal notranslate"><span class="pre">RejectedRefList</span></code> list contains the frame order
of the frames that should be unmarked as long term frames. The application can
only mark or unmark the frames that are buffered inside the encoder. Because of
this, it is recommended that the application marks a frame when it is submitted
for encoding. The application can either explicitly unmark long term reference
frames or wait for the IDR frame. When the IDR frame is reached, all long term
reference frames will be unmarked.</p>
<p>The oneVPL encoder puts all long term reference frames at the end of a reference
frame list. If the number of active reference frames (the <code class="docutils literal notranslate"><span class="pre">NumRefIdxL0Active</span></code>
and <code class="docutils literal notranslate"><span class="pre">NumRefIdxL1Active</span></code> values in the <a class="reference internal" href="../API_ref/VPL_structs_encode.html#_CPPv420mfxExtAVCRefListCtrl" title="mfxExtAVCRefListCtrl"><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">mfxExtAVCRefListCtrl</span></code></a>
extended buffer) is less than than the total reference frame number (the
<code class="docutils literal notranslate"><span class="pre">NumRefFrame</span></code> value in the <a class="reference internal" href="../API_ref/VPL_structs_cross_component.html#_CPPv410mfxInfoMFX" title="mfxInfoMFX"><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">mfxInfoMFX</span></code></a> structure during the
encoding initialization), the encoder may ignore some or all long term
reference frames. The application may avoid this by providing a list of preferred
reference frames in the <code class="docutils literal notranslate"><span class="pre">PreferredRefList</span></code> list in the
<a class="reference internal" href="../API_ref/VPL_structs_encode.html#_CPPv420mfxExtAVCRefListCtrl" title="mfxExtAVCRefListCtrl"><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">mfxExtAVCRefListCtrl</span></code></a> extended buffer. In this case, the encoder
reorders the reference list based on the specified list.</p>
</div>
<div class="section" id="temporal-scalability">
<h2>Temporal Scalability<a class="headerlink" href="#temporal-scalability" title="Permalink to this headline">¶</a></h2>
<p>The application may specify the temporal hierarchy of frames by using the
<a class="reference internal" href="../API_ref/VPL_structs_encode.html#_CPPv423mfxExtAvcTemporalLayers" title="mfxExtAvcTemporalLayers"><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">mfxExtAvcTemporalLayers</span></code></a> extended buffer during the encoder
initialization in the display order encoding mode. oneVPL inserts the prefix
NAL unit before each slice with a unique temporal and priority ID. The temporal
ID starts from zero and the priority ID starts from the <code class="docutils literal notranslate"><span class="pre">BaseLayerPID</span></code> value.
oneVPL increases the temporal ID and priority ID value by one for each
consecutive layer.</p>
<p>If the application needs to specify a unique sequence or picture parameter set
ID, the application must use the <a class="reference internal" href="../API_ref/VPL_structs_encode.html#_CPPv424mfxExtCodingOptionSPSPPS" title="mfxExtCodingOptionSPSPPS"><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">mfxExtCodingOptionSPSPPS</span></code></a>
extended buffer, with all pointers and sizes set to zero and valid
<code class="docutils literal notranslate"><span class="pre">SPSId</span></code> and <code class="docutils literal notranslate"><span class="pre">PPSId</span></code> fields. The same SPS and PPS ID will be used for all
temporal layers.</p>
<p>Each temporal layer is a set of frames with the same temporal ID. Each layer is
defined by the <code class="docutils literal notranslate"><span class="pre">Scale</span></code> value. The scale for layer N is equal to the ratio
between the frame rate of subsequent temporal layers with a temporal ID less
than or equal to N and the frame rate of the base temporal layer. The application
may skip some temporal layers by specifying the <code class="docutils literal notranslate"><span class="pre">Scale</span></code> value as zero. The
application should use an integer ratio of the frame rates for two consecutive
temporal layers.</p>
<p>For example, a video sequence with 30 frames/second is typically separated by
three temporal layers that can be decoded as 7.5 fps (base layer), 15 fps (base
and first temporal layer) and 30 fps (all three layers). In this scenario,
<code class="docutils literal notranslate"><span class="pre">Scale</span></code> should have the values {1,2,4,0,0,0,0,0}.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="VPL_apnds_d.html" class="btn btn-neutral float-right" title="Switchable Graphics and Multiple Monitors" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="VPL_apnds_b.html" class="btn btn-neutral float-left" title="Multiple-segment Encoding" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Intel Corporation

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>