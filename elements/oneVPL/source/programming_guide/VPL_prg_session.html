<!--
SPDX-FileCopyrightText: 2019-2020 Intel Corporation

SPDX-License-Identifier: MIT
-->



<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>oneVPL Session &mdash; oneAPI Specification 1.0-rev-2 documentation</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../../../_static/favicons.png"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/language_data.js"></script>
        <script src="../../../../_static/custom.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Frame and Fields" href="VPL_prg_frame.html" />
    <link rel="prev" title="Status Codes" href="VPL_prg_stc.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="https://oneapi.com" class="icon icon-home"> oneAPI Specification
          

          
            
            <img src="../../../../_static/oneAPI-rgb-rev-100.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.0-rev-2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../architecture.html">Software Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dpcpp/source/index.html">DPC++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneDPL/source/index.html">oneDPL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneDNN/source/index.html">oneDNN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneCCL/source/index.html">oneCCL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../l0/source/index.html">Level Zero</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneDAL/source/index.html">oneDAL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneTBB/source/nested-index.html">oneTBB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">oneVPL</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html#onevpl-specification-version">oneVPL Specification Version</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../architecture/index.html">Architecture</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Programming Guide</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="VPL_prg_stc.html">Status Codes</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">oneVPL Session</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#msdk-full-name-dispatcher-legacy">|msdk_full_name| Dispatcher (Legacy)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#onevpl-dispatcher">oneVPL Dispatcher</a></li>
<li class="toctree-l4"><a class="reference internal" href="#multiple-sessions">Multiple Sessions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="VPL_prg_frame.html">Frame and Fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="VPL_prg_decoding.html">Decoding Procedures</a></li>
<li class="toctree-l3"><a class="reference internal" href="VPL_prg_encoding.html">Encoding Procedures</a></li>
<li class="toctree-l3"><a class="reference internal" href="VPL_prg_vpp.html">Video Processing Procedures</a></li>
<li class="toctree-l3"><a class="reference internal" href="VPL_prg_transcoding.html">Transcoding Procedures</a></li>
<li class="toctree-l3"><a class="reference internal" href="VPL_prg_hw.html">Hardware Acceleration</a></li>
<li class="toctree-l3"><a class="reference internal" href="VPL_prg_mem.html">Memory Allocation and External Allocators</a></li>
<li class="toctree-l3"><a class="reference internal" href="VPL_prg_err.html">Hardware Device Error Handling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../VPL_summary.html">Mandatory APIs and Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../API_ref/VPL_api_ref.html">oneVPL API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Versioning.html">oneVPL API Versioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/index.html">Appendices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../VPL_acronyms.html">Glossary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneMKL/source/index.html">oneMKL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../versions.html">HTML and PDF Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notices.html">Legal Notices and Disclaimers</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">oneAPI Specification</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          <!--
SPDX-FileCopyrightText: 2019-2020 Intel Corporation

SPDX-License-Identifier: MIT
-->

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">oneAPI Specification</a> &raquo;</li>
        
          
          <li><a href="../index.html">oneVPL</a> </li>
          
        
          
        
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/oneapi-src/oneapi-spec/blob/master/source/elements/oneVPL/source/programming_guide/VPL_prg_session.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="onevpl-session">
<span id="sdk-session"></span><h1>oneVPL Session<a class="headerlink" href="#onevpl-session" title="Permalink to this headline">¶</a></h1>
<p>Before calling any oneVPL functions, the application must initialize the
library and create a oneVPL session. A oneVPL session maintains context for the
use of any of <a class="reference internal" href="../architecture/index.html#term-DECODE"><span class="xref std std-term">DECODE</span></a>, <a class="reference internal" href="../architecture/index.html#term-ENCODE"><span class="xref std std-term">ENCODE</span></a>, <a class="reference internal" href="../architecture/index.html#term-VPP"><span class="xref std std-term">VPP</span></a>, <a class="reference internal" href="../architecture/index.html#term-DECODE_VPP"><span class="xref std std-term">DECODE_VPP</span></a>
functions.</p>
<div class="section" id="msdk-full-name-dispatcher-legacy">
<h2><a href="#id4"><span class="problematic" id="id5">|msdk_full_name|</span></a> Dispatcher (Legacy)<a class="headerlink" href="#msdk-full-name-dispatcher-legacy" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="../API_ref/VPL_func_session.html#_CPPv47MFXInit7mfxIMPLP10mfxVersionP10mfxSession" title="MFXInit"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXInit()</span></code></a> or <a class="reference internal" href="../API_ref/VPL_func_session.html#_CPPv49MFXInitEx12mfxInitParamP10mfxSession" title="MFXInitEx"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXInitEx()</span></code></a> function starts (initializes)
a session. The <a class="reference internal" href="../API_ref/VPL_func_session.html#_CPPv48MFXClose10mfxSession" title="MFXClose"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXClose()</span></code></a> function closes (de-initializes) the
session. To avoid memory leaks, always call <a class="reference internal" href="../API_ref/VPL_func_session.html#_CPPv48MFXClose10mfxSession" title="MFXClose"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXClose()</span></code></a> after
<a class="reference internal" href="../API_ref/VPL_func_session.html#_CPPv47MFXInit7mfxIMPLP10mfxVersionP10mfxSession" title="MFXInit"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXInit()</span></code></a>.</p>
<p>The application can initialize a session as a software-based session
(<a class="reference internal" href="../API_ref/VPL_enums.html#_CPPv417MFX_IMPL_SOFTWARE" title="MFX_IMPL_SOFTWARE"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">MFX_IMPL_SOFTWARE</span></code></a>) or a hardware-based session
(<a class="reference internal" href="../API_ref/VPL_enums.html#_CPPv417MFX_IMPL_HARDWARE" title="MFX_IMPL_HARDWARE"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">MFX_IMPL_HARDWARE</span></code></a>). In a software-based session, the SDK
functions execute on a CPU. In a hardware-base session, the SDK functions
use platform acceleration capabilities. For platforms that expose multiple
graphic devices, the application can initialize a session on any
alternative graphic device using the <a class="reference internal" href="../API_ref/VPL_enums.html#_CPPv417MFX_IMPL_HARDWARE" title="MFX_IMPL_HARDWARE"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">MFX_IMPL_HARDWARE</span></code></a>,
<a class="reference internal" href="../API_ref/VPL_enums.html#_CPPv418MFX_IMPL_HARDWARE2" title="MFX_IMPL_HARDWARE2"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">MFX_IMPL_HARDWARE2</span></code></a>, <a class="reference internal" href="../API_ref/VPL_enums.html#_CPPv418MFX_IMPL_HARDWARE3" title="MFX_IMPL_HARDWARE3"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">MFX_IMPL_HARDWARE3</span></code></a>, or
<a class="reference internal" href="../API_ref/VPL_enums.html#_CPPv418MFX_IMPL_HARDWARE4" title="MFX_IMPL_HARDWARE4"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">MFX_IMPL_HARDWARE4</span></code></a> values of <a class="reference internal" href="../API_ref/VPL_enums.html#_CPPv47mfxIMPL" title="mfxIMPL"><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">mfxIMPL</span></code></a>.</p>
<p>The application can also initialize a session to be automatic (
<a class="reference internal" href="../API_ref/VPL_enums.html#_CPPv413MFX_IMPL_AUTO" title="MFX_IMPL_AUTO"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">MFX_IMPL_AUTO</span></code></a> or <a class="reference internal" href="../API_ref/VPL_enums.html#_CPPv417MFX_IMPL_AUTO_ANY" title="MFX_IMPL_AUTO_ANY"><code class="xref cpp cpp-enumerator docutils literal notranslate"><span class="pre">MFX_IMPL_AUTO_ANY</span></code></a>),
instructing the dispatcher library to detect the platform capabilities and
choose the best SDK library available. After initialization, the SDK returns the
actual implementation through the <a class="reference internal" href="../API_ref/VPL_func_session.html#_CPPv412MFXQueryIMPL10mfxSessionP7mfxIMPL" title="MFXQueryIMPL"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXQueryIMPL()</span></code></a> function.</p>
<p>Internally, the dispatcher works as follows:</p>
<ol class="arabic">
<li><p>Dispatcher searches for the shared library with the specific name:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 25%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>OS</strong></p></th>
<th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Linux*</p></td>
<td><p>libmfxsw64.so.1</p></td>
<td><p>64-bit software-based implementation</p></td>
</tr>
<tr class="row-odd"><td><p>Linux</p></td>
<td><p>libmfxsw32.so.1</p></td>
<td><p>32-bit software-based implementation</p></td>
</tr>
<tr class="row-even"><td><p>Linux</p></td>
<td><p>libmfxhw64.so.1</p></td>
<td><p>64-bit hardware-based implementation</p></td>
</tr>
<tr class="row-odd"><td><p>Linux</p></td>
<td><p>libmfxhw64.so.1</p></td>
<td><p>32-bit hardware-based implementation</p></td>
</tr>
<tr class="row-even"><td><p>Windows*</p></td>
<td><p>libmfxsw32.dll</p></td>
<td><p>64-bit software-based implementation</p></td>
</tr>
<tr class="row-odd"><td><p>Windows</p></td>
<td><p>libmfxsw32.dll</p></td>
<td><p>32-bit software-based implementation</p></td>
</tr>
<tr class="row-even"><td><p>Windows</p></td>
<td><p>libmfxhw64.dll</p></td>
<td><p>64-bit hardware-based implementation</p></td>
</tr>
<tr class="row-odd"><td><p>Windows</p></td>
<td><p>libmfxhw64.dll</p></td>
<td><p>32-bit hardware-based implementation</p></td>
</tr>
</tbody>
</table>
</li>
<li><p>Once the library is loaded, the dispatcher obtains addresses for each SDK
function. See the
<a class="reference internal" href="../VPL_summary.html#export-func-version-table-2x"><span class="std std-ref">Exported Functions/API Version table</span></a> for
the list of functions to expose.</p></li>
</ol>
<p id="legacy-search-order">How the shared library is identified using the implementation search strategy
will vary according to the OS.</p>
<ul>
<li><p>On Windows, the dispatcher searches the following locations, in the specified
order, to find the correct implementation library:</p>
<ol class="arabic simple">
<li><p>The <code class="file docutils literal notranslate"><span class="pre">Driver</span> <span class="pre">Store</span></code> directory for the current adapter.
All types of graphics drivers can install libraries in this directory. <a class="reference external" href="https://docs.microsoft.com/en-us/windows-hardware/drivers/install/driver-store">Learn more about Driver Store</a>.</p></li>
<li><p>The directory specified for the current hardware under the registry key
<code class="docutils literal notranslate"><span class="pre">HKEY_CURRENT_USER\Software\Intel\MediaSDK\Dispatch</span></code>.</p></li>
<li><p>The directory specified for the current hardware under the registry key
<code class="docutils literal notranslate"><span class="pre">HKEY_LOCAL_MACHINE\Software\Intel\MediaSDK\Dispatch</span></code>.</p></li>
<li><p>The directory that is stored in these registry keys: <code class="file docutils literal notranslate"><span class="pre">C:Program</span> <span class="pre">FilesIntelMedia</span> <span class="pre">SDK</span></code>.
This directory is where legacy graphics drivers install libraries.</p></li>
<li><p>The directory where the current module (the module that links the dispatcher)
is located (only if the current module is a dll).</p></li>
</ol>
<p>After the dispatcher completes the main search, it additionally checks:</p>
<ol class="arabic simple">
<li><p>The directory of the exe file of the current process, where it looks for
software implementation only, regardless of which implementation the
application requested.</p></li>
<li><p>Default dll search. This provides loading from the directory of the
application’s exe file and from the <code class="file docutils literal notranslate"><span class="pre">System32</span></code> and <code class="file docutils literal notranslate"><span class="pre">SysWOW64</span></code>
directories. <a class="reference external" href="https://docs.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-search-order?redirectedfrom=MSDN#search-order-for-desktop-applications">Learn more about default dll search order</a>.</p></li>
<li><p>The <code class="file docutils literal notranslate"><span class="pre">System32</span></code> and <code class="file docutils literal notranslate"><span class="pre">SysWOW64</span></code> directories, which is where DCH
graphics drivers install libraries.</p></li>
</ol>
</li>
<li><p>On Linux, the dispatcher searches the following locations, in the specified
order, to find the correct implementation library:</p>
<ol class="arabic simple">
<li><p>Directories provided by the environment variable <code class="docutils literal notranslate"><span class="pre">LD_LIBRARY_PATH</span></code>.</p></li>
<li><p>Content of the <code class="file docutils literal notranslate"><span class="pre">/etc/ld.so.cache</span></code> cache file.</p></li>
<li><p>Default path <code class="file docutils literal notranslate"><span class="pre">/lib</span></code>, then :file`/usr/lib` or <code class="file docutils literal notranslate"><span class="pre">/lib64</span></code>, and then
<code class="file docutils literal notranslate"><span class="pre">/usr/lib64</span></code> on some 64 bit OSs. On Debian: <code class="file docutils literal notranslate"><span class="pre">/usr/lib/x86_64-linux-gnu</span></code>.</p></li>
<li><p>SDK installation folder.</p></li>
</ol>
</li>
</ul>
</div>
<div class="section" id="onevpl-dispatcher">
<h2>oneVPL Dispatcher<a class="headerlink" href="#onevpl-dispatcher" title="Permalink to this headline">¶</a></h2>
<p>The oneVPL dispatcher extends the legacy dispatcher by providing additional
ability to select the appropriate implementation based on the implementation
capabilities. Implementation capabilities include information about supported
decoders, encoders, and VPP filters. For each supported encoder, decoder, and
filter, capabilities include information about supported memory types, color
formats, and image (frame) size in pixels.</p>
<p>The recommended approach to configure the dispatcher’s capabilities
search filters and to create a session based on a suitable implementation is as
follows:</p>
<ol class="arabic simple">
<li><p>Create loader with <a class="reference internal" href="../API_ref/VPL_disp_api_func.html#_CPPv47MFXLoadv" title="MFXLoad"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXLoad()</span></code></a>.</p></li>
<li><p>Create loader’s configuration with <a class="reference internal" href="../API_ref/VPL_disp_api_func.html#_CPPv415MFXCreateConfig9mfxLoader" title="MFXCreateConfig"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXCreateConfig()</span></code></a>.</p></li>
<li><p>Add configuration properties with <a class="reference internal" href="../API_ref/VPL_disp_api_func.html#_CPPv426MFXSetConfigFilterProperty9mfxConfigPK5mfxU810mfxVariant" title="MFXSetConfigFilterProperty"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXSetConfigFilterProperty()</span></code></a>.</p></li>
<li><p>Explore available implementations with <a class="reference internal" href="../API_ref/VPL_disp_api_func.html#_CPPv422MFXEnumImplementations9mfxLoader6mfxU3225mfxImplCapsDeliveryFormatP6mfxHDL" title="MFXEnumImplementations"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXEnumImplementations()</span></code></a>.</p></li>
<li><p>Create a suitable session with <a class="reference internal" href="../API_ref/VPL_disp_api_func.html#_CPPv416MFXCreateSession9mfxLoader6mfxU32P10mfxSession" title="MFXCreateSession"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXCreateSession()</span></code></a>.</p></li>
</ol>
<p>The procedure to terminate an application is as follows:</p>
<ol class="arabic simple">
<li><p>Destroy session with <a class="reference internal" href="../API_ref/VPL_func_session.html#_CPPv48MFXClose10mfxSession" title="MFXClose"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXClose()</span></code></a>.</p></li>
<li><p>Destroy loader with <a class="reference internal" href="../API_ref/VPL_disp_api_func.html#_CPPv49MFXUnload9mfxLoader" title="MFXUnload"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXUnload()</span></code></a>.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Multiple loader instances can be created.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Each loader may have multiple configuration objects associated with it.
When a configuration object is modified through <a class="reference internal" href="../API_ref/VPL_disp_api_func.html#_CPPv426MFXSetConfigFilterProperty9mfxConfigPK5mfxU810mfxVariant" title="MFXSetConfigFilterProperty"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXSetConfigFilterProperty()</span></code></a>
it implicitly impacts the state and configuration of the associated loader.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>One configuration object can handle only one filter property.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Multiple sessions can be created by using one loader object.</p>
</div>
<p>When the dispatcher searches for the implementation, it uses the following
priority rules:</p>
<ol class="arabic simple">
<li><p>Hardware implementation has priority over software implementation.</p></li>
<li><p>General hardware implementation has priority over VSI hardware implementation.</p></li>
<li><p>Highest API version has higher priority over lower API version.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Implementation has priority over the API version. In other words, the
dispatcher must return the implementation with the highest API
priority (greater than or equal to the implementation requested).</p>
</div>
<p>The dispatcher searches for the implementation in the following folders at
runtime, in priority order:</p>
<ol class="arabic simple">
<li><p>User-defined search folders.</p></li>
<li><p>oneVPL package.</p></li>
<li><p>Path from <span class="target" id="index-0"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code> or <span class="target" id="index-1"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">LD_LIBRARY_PATH</span></code> environmental variables,
depending on OS.</p></li>
<li><p>Default system folders.</p></li>
<li><p>Standalone <a href="#id6"><span class="problematic" id="id7">|msdk_full_name|</span></a> package (or driver).</p></li>
</ol>
<p>For more details, see the <a class="reference external" href="legacy_search_order">legacy dispatcher search order</a>.</p>
<p>A user can develop their own implementation and direct the oneVPL dispatcher to
load their implementation by providing a list of search folders. The specific
steps depend on which OS is used.</p>
<ul class="simple">
<li><p>Linux: User can provide a colon separated list of folders in the
<span class="target" id="index-2"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">ONEVPL_SEARCH_PATH</span></code> environmental variable.</p></li>
<li><p>Windows: User can provide a semicolon separated list of folders in the
<span class="target" id="index-3"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">ONEVPL_SEARCH_PATH</span></code> environmental variable. Alternatively, the user
can use the Windows registry.</p></li>
</ul>
<table class="colwidths-given docutils align-default" id="id3">
<caption><span class="caption-text">Dispatcher Environmental Variables</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 40%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Variable</strong></p></th>
<th class="head"><p><strong>Purpose</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="target" id="index-4"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">ONEVPL_SEARCH_PATH</span></code></p></td>
<td><p>List of user-defined search folders used by the dispatcher during implementation search.</p></td>
</tr>
</tbody>
</table>
<p>The dispatcher supports different software implementations. The user can use
the <a class="reference internal" href="../API_ref/VPL_disp_api_struct.html#_CPPv4N18mfxImplDescription8VendorIDE" title="mfxImplDescription::VendorID"><code class="xref cpp cpp-member docutils literal notranslate"><span class="pre">mfxImplDescription::VendorID</span></code></a> field, the
<a class="reference internal" href="../API_ref/VPL_disp_api_struct.html#_CPPv4N18mfxImplDescription12VendorImplIDE" title="mfxImplDescription::VendorImplID"><code class="xref cpp cpp-member docutils literal notranslate"><span class="pre">mfxImplDescription::VendorImplID</span></code></a> field, or the
<a class="reference internal" href="../API_ref/VPL_disp_api_struct.html#_CPPv4N18mfxImplDescription8ImplNameE" title="mfxImplDescription::ImplName"><code class="xref cpp cpp-member docutils literal notranslate"><span class="pre">mfxImplDescription::ImplName</span></code></a> field to search for the specific
implementation.</p>
<p>Internally, the dispatcher works as follows:</p>
<ol class="arabic simple">
<li><p>Dispatcher loads any shared library with <cite>libvpl*</cite> prefix in the library name
in the given search folders.</p></li>
<li><p>For each loaded library, the dispatcher tries to resolve address of the
<code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXQueryImplsCapabilities()</span></code> function to collect the implementation’s
capabilities.</p></li>
<li><p>Once the user has requested to create the session based on this implementation,
the dispatcher obtains addresses of each oneVPL function. See the
<a class="reference internal" href="../VPL_summary.html#export-func-version-table-2x"><span class="std std-ref">Exported Functions/API Version table</span></a> for
the list of functions to export.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For backward compatibility with <a href="#id8"><span class="problematic" id="id9">|msdk_full_name|</span></a>, the dispatcher will
first try to load <a href="#id10"><span class="problematic" id="id11">|msdk_full_name|</span></a> if API version 1.x was requested.
If loading fails, the dispatcher will search for the implementation with highest 2.x API version and load that version.</p>
</div>
</div>
<div class="section" id="multiple-sessions">
<h2>Multiple Sessions<a class="headerlink" href="#multiple-sessions" title="Permalink to this headline">¶</a></h2>
<p>Each oneVPL session can run exactly one instance of the DECODE, ENCODE, and
VPP functions. This is adequate for a simple transcoding operation. If the
application needs more than one instance of DECODE, ENCODE, or VPP
in a complex transcoding setting or needs more simultaneous transcoding
operations to balance CPU/GPU workloads, the application can initialize multiple
oneVPL sessions. Each independent oneVPL session can be a software-based session or
hardware-based session.</p>
<p>The application can use multiple oneVPL sessions independently or run a “joined”
session. Independently operated oneVPL sessions cannot share data unless the
application explicitly synchronizes session operations. This is to ensure that
data is valid and complete before passing from the source to the destination
session.</p>
<p>To join two sessions together, the application can use the function
<a class="reference internal" href="../API_ref/VPL_func_session.html#_CPPv414MFXJoinSession10mfxSession10mfxSession" title="MFXJoinSession"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXJoinSession()</span></code></a>. Alternatively, the application can use the
<a class="reference internal" href="../API_ref/VPL_func_session.html#_CPPv415MFXCloneSession10mfxSessionP10mfxSession" title="MFXCloneSession"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXCloneSession()</span></code></a> function to duplicate an existing session. Joined
oneVPL sessions work together as a single session, sharing all session resources,
threading control, and prioritization operations except hardware acceleration
devices and external allocators. When joined, the first session (first join)
serves as the parent session and will schedule execution resources with all
other child sessions. Child sessions rely on the parent session for resource
management.</p>
<p>With joined sessions, the application can set the priority of session operations
through the <a class="reference internal" href="../API_ref/VPL_func_session.html#_CPPv414MFXSetPriority10mfxSession11mfxPriority" title="MFXSetPriority"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXSetPriority()</span></code></a> function. A lower priority session
receives fewer CPU cycles. Session priority does not affect hardware accelerated
processing.</p>
<p>After the completion of all session operations, the application can use the
<a class="reference internal" href="../API_ref/VPL_func_session.html#_CPPv417MFXDisjoinSession10mfxSession" title="MFXDisjoinSession"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">MFXDisjoinSession()</span></code></a> function to remove the joined state of a session.
Do not close the parent session until all child sessions are disjoined or closed.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="VPL_prg_frame.html" class="btn btn-neutral float-right" title="Frame and Fields" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="VPL_prg_stc.html" class="btn btn-neutral float-left" title="Status Codes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Intel Corporation

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>